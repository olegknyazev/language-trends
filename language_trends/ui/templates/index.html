<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"></script>
    <link href="index.css" rel="stylesheet">
    <title>Language Trends</title>
  </head>
  <body>
    <div class="container">
      <canvas id="chart"></canvas>
      <script>
        $(document).ready(() => {
          $.ajax('api/commits', {
            dataType: 'json',
            data: {language: 'clojure'},
            success: result => {
              let ctx = document.getElementById("chart").getContext('2d');
              let myChart = new Chart(ctx, {
                type: 'line',
                data: {
                  labels: result.map(r => new Date(r[0])),
                  datasets: [{
                    label: 'Clojure',
                    borderColor: 'rgba(255, 0, 0, 0.5)',
                    backgroundColor: 'rgba(255, 0, 0, 0.1)',
                    fill: 'bottom',
                    lineTension: 0,
                    data: result.map(r => r[1])
                  }]
                },
                options: {
                  legend: {
                    position: 'right'
                  },
                  elements: {
                    line: {
                      borderWidth: 2
                    },
                    point: {
                      radius: 0
                    }
                  },
                  scales: {
                    xAxes: [{
                      type: 'time',
                      time: {
                        unit: 'year'
                      }
                    }]
                  }
                }
              });
            }})
        });
      </script>
    </div>
  </body>
</html>
